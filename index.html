<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>סיפורי שימי</title>
    <!-- Tailwind CSS CDN for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Link to the external stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">סיפורי שימי</h1>
        <div id="phraseDisplay" class="phrase-display">
            <!-- Initial phrase or prompt will be loaded here by JavaScript -->
        </div>
        <div id="phraseUrlDisplay" class="url-display">
            <!-- URL will be displayed here -->
        </div>
        <button id="choosePhraseBtn" class="choose-button">
            !תביא סיפור
        </button>
    </div>

    <!-- Import the phrases from a separate file -->
    <script src="phrases.js"></script>
    <script>
        // Get references to the HTML elements
        const choosePhraseBtn = document.getElementById('choosePhraseBtn');
        const phraseDisplay = document.getElementById('phraseDisplay');
        const phraseUrlDisplay = document.getElementById('phraseUrlDisplay');

        // Array to keep track of indices of phrases that have already been displayed
        let displayedPhraseIndices = [];

        // Function to display a random phrase and its URL
        function displayRandomPhrase() {
            // If all phrases have been displayed, reset the array to start a new cycle
            if (displayedPhraseIndices.length === phrases.length) {
                displayedPhraseIndices = []; // Reset the stack
                console.log("All phrases displayed. Resetting stack."); // Optional: log to console
            }

            let randomIndex;
            let randomPhraseObject;
            let isDuplicate;

            // Loop until a unique phrase (index not yet displayed) is found
            do {
                randomIndex = Math.floor(Math.random() * phrases.length);
                randomPhraseObject = phrases[randomIndex];
                isDuplicate = displayedPhraseIndices.includes(randomIndex);
            } while (isDuplicate);

            // Add the chosen unique index to the list of displayed phrases
            displayedPhraseIndices.push(randomIndex);

            // Create a clickable link for the phrase/title
            const phraseLink = document.createElement('a');
            phraseLink.href = randomPhraseObject.url;
            phraseLink.textContent = randomPhraseObject.phrase;
            phraseLink.target = "_blank"; // Open link in a new tab
            phraseLink.classList.add('phrase-link'); // Add a class for styling if needed

            // Clear previous content and append the new link
            phraseDisplay.innerHTML = ''; // Clear existing content
            phraseDisplay.appendChild(phraseLink);

            // Display the URL below the phrase
            phraseUrlDisplay.innerHTML = `<a href="${randomPhraseObject.url}" target="_blank" class="text-blue-600 hover:underline text-sm mt-2 block">${randomPhraseObject.url}</a>`;
        }

        // Add an event listener to the button
        choosePhraseBtn.addEventListener('click', displayRandomPhrase);

        // Display an initial phrase when the page loads
        document.addEventListener('DOMContentLoaded', displayRandomPhrase);
    </script>
</body>
</html>
